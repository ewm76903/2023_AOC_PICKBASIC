PROGRAM DAY_2
*
OPEN 'UNIX.FILE' TO F.UNIX ELSE
  CRT 'CANNOT OPEN UNIX.FILE'
  STOP
END
IDATA=""
READ IDATA FROM F.UNIX,'E1' ELSE
  CRT 'NO E1 IN UNIX.FILE'
  STOP
END
*
LCNT=DCOUNT(IDATA,@AM)
REDMAX=12
GREENMAX=13
BLUEMAX=14
GAMECNT=0
*
CRT 'Start parsing of data PART 1'
FOR I = 1 TO LCNT
  GLINE=""
  GNUM=""
  GLINE=IDATA<I>
  CRT '  ':GLINE
  GNUM=FIELD(GLINE,':',1)
  GNUM=OCONV(GNUM,'MCN')
  CRT '  GAME# = ':GNUM
  GLINE=FIELD(GLINE,':',2)  ;*REMOVE THE "Game #"
  GLINE=CHANGE(GLINE,';',@VM)  ;*LOOP THRU
  ISTRUE=1
  VCNT=DCOUNT(GLINE<1>,@VM)
  *LOOP THRU THE EXAMPLES 
  FOR K = 1 TO VCNT
    EXAMPLE=""
    EXAMPLE=GLINE<1,K>
    EXAMPLE=OCONV(EXAMPLE,'MCU')
    EXAMPLE=CHANGE(EXAMPLE,',',@VM)
    XCNT=DCOUNT(EXAMPLE<1>,@VM)
    *TEST EACH EXAMPLE TO SEE IF NUM IS GT ALLOWED FOR COLOR
    FOR X = 1 TO XCNT
      XX=""
      XX=EXAMPLE<1,X>
      XX=TRIM(XX)
      CRT '  EXAMPLE#':X:'  "':XX:'"'
      XNUM=""
      XCOLOR=""
      XNUM=FIELD(XX,' ',1)
      XCOLOR=FIELD(XX,' ',2)
      CRT '     XNUM = ':XNUM
      CRT '     XCOLOR = ':XCOLOR
      BEGIN CASE
        CASE XCOLOR='RED'
          CRT '  EXAMPLE PULL IS RED, WITH XNUM=':XNUM:' MAX ALLOWED=':REDMAX
          IF XNUM GT REDMAX THEN ISTRUE=0
        CASE XCOLOR='BLUE'
          CRT '  EXAMPLE PULL IS BLUE, WITH XNUM=':XNUM:' MAX ALLOWED=':BLUEMAX
          IF XNUM GT BLUEMAX THEN ISTRUE=0
        CASE XCOLOR='GREEN'
          CRT '  EXAMPLE PULL IS GREEN, WITH XNUM=':XNUM:' MAX ALLOWED=':GREENMAX
          IF XNUM GT GREENMAX THEN ISTRUE=0
      END CASE
      CRT '  ISTRUE = ':ISTRUE
    NEXT X
  NEXT K
  *--*
  *ANYTHING=""
  *INPUT ANYTHING
  *IF ANYTHING='STOP' OR ANYTHING='X' THEN STOP
  *--*
  *NOW ADD IF ISTRUE IS = "1"
  IF ISTRUE=1 THEN
    GAMECNT+=GNUM
  END
NEXT I
*
CRT 'NUM OF GAMES = ':GAMECNT
*
*
CRT 'Start parsing of data, PART 2 Find the fewest possible number of each type, then multiple together and add to total power'
TOTPOWER=0
FOR I = 1 TO LCNT
  GLINE=""
  GNUM=""
  GLINE=IDATA<I>
  CRT '  ':GLINE
  GNUM=FIELD(GLINE,':',1)
  GNUM=OCONV(GNUM,'MCN')
  CRT '  GAME# = ':GNUM
  GLINE=FIELD(GLINE,':',2)  ;*REMOVE THE "Game #"
  GLINE=CHANGE(GLINE,';',@VM)  ;*LOOP THRU
  ISTRUE=1
  MINRED=0
  MINBLUE=0
  MINGREEN=0
  VCNT=DCOUNT(GLINE<1>,@VM)
  *LOOP THRU THE EXAMPLES 
  FOR K = 1 TO VCNT
    EXAMPLE=""
    EXAMPLE=GLINE<1,K>
    EXAMPLE=OCONV(EXAMPLE,'MCU')
    EXAMPLE=CHANGE(EXAMPLE,',',@VM)
    XCNT=DCOUNT(EXAMPLE<1>,@VM)
    *TEST EACH EXAMPLE TO SEE IF NUM IS GT ALLOWED FOR COLOR
    FOR X = 1 TO XCNT
      XX=""
      XX=EXAMPLE<1,X>
      XX=TRIM(XX)
      CRT '  EXAMPLE#':X:'  "':XX:'"'
      XNUM=""
      XCOLOR=""
      XNUM=FIELD(XX,' ',1)
      XCOLOR=FIELD(XX,' ',2)
      CRT '     XNUM = ':XNUM
      CRT '     XCOLOR = ':XCOLOR
      BEGIN CASE
        CASE XCOLOR='RED'
          CRT '  EXAMPLE PULL IS RED, WITH XNUM=':XNUM
          CRT '      MINRED = ':MINRED
          IF MINRED=0 THEN
             MINRED=XNUM
          END ELSE
             IF XNUM GT MINRED THEN
               MINRED=XNUM
             END
          END
          CRT '      MINRED = ':MINRED
        CASE XCOLOR='BLUE'
          CRT '  EXAMPLE PULL IS BLUE, WITH XNUM=':XNUM
          CRT '      MINBLUE = ':MINBLUE
          IF MINBLUE=0 THEN
             MINBLUE=XNUM
          END ELSE
             IF XNUM GT MINBLUE THEN
               MINBLUE=XNUM
             END
          END
          CRT '      MINBLUE = ':MINBLUE
        CASE XCOLOR='GREEN'
          CRT '  EXAMPLE PULL IS GREEN, WITH XNUM=':XNUM
          CRT '      MINGREEN = ':MINGREEN
          IF MINGREEN=0 THEN
             MINGREEN=XNUM
          END ELSE
             IF XNUM GT MINGREEN THEN
               MINGREEN=XNUM
             END
          END
          CRT '      MINGREEN = ':MINGREEN
      END CASE
    NEXT X
  NEXT K
  *--*
  CRT '  MINRED = ':MINRED:', MINBLUE = ':MINBLUE:', MINGREEN = ':MINGREEN
  GAMEPOWER=""
  GAMEPOWER=MINRED*MINBLUE
  GAMEPOWER=GAMEPOWER*MINGREEN
  CRT '  GAMEPOWER = ':GAMEPOWER
  *ANYTHING=""
  *INPUT ANYTHING
  *IF ANYTHING='STOP' OR ANYTHING='X' THEN STOP
  *--*
  CRT 'ADD GAMEPOWER TO TOTPOWER'
  TOTPOWER+=GAMEPOWER
  CRT 'TOTPOWER = ':TOTPOWER
NEXT I
*
CRT 'FINAL TOTPOWER = ':TOTPOWER
STOP
END
